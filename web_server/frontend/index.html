<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Robot Live Stream</title>
<style>
    body { text-align: center; font-family: sans-serif; background: #111; color: #eee; }
    img {
        width: 80vw;
        max-width: 100%;
        height: auto;
        border: 2px solid #555;
        border-radius: 6px;
        margin-top: 20px;
        }
    #status { margin-top: 10px; font-size: 1.1em; }
</style>
<script src="https://cdn.jsdelivr.net/npm/roslib/build/roslib.min.js"></script>
</head>
<body>
<h1>Robot Camera</h1>
<div style="text-align:center;">
  <img id="stream" src="" alt="Waiting for stream..." />
</div>
<div id="status">Connecting...</div>
<pre id="data"></pre>

<script>
const imgEl = document.getElementById('stream');
const statusEl = document.getElementById('status');
const dataEl = document.getElementById('data');

const rosbridgeUrl = 'wss://intermeasurable-unbearably-sondra.ngrok-free.dev'
const ros = new ROSLIB.Ros({
  url: rosbridgeUrl
});

ros.on('connection', () => statusEl.textContent = 'Connected to ROS');
ros.on('error', (err) => statusEl.textContent = 'Error connecting');
ros.on('close', () => statusEl.textContent = 'Connection closed');

const infoTopic = new ROSLIB.Topic({
  ros: ros,
  name: '/camera/info',
  messageType: 'std_msgs/msg/Float32MultiArray'
});

infoTopic.subscribe((msg) => {
  dataEl.textContent = JSON.stringify(msg.data, null, 2);
});
</script>
</body>
</html>